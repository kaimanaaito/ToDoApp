<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To Do List</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* タスク名の幅を200pxに設定 */
        .task input[type="text"] {
            width: 200px; /* 幅を200pxに設定 */
            padding: 5px; /* 内側の余白を追加 */
            margin-right: 10px; /* 隣の要素との間隔を追加 */
        }
        
        /* 傍線を追加するためのスタイル */
        .task.completed input[type="text"] {
            text-decoration: line-through; /* 傍線を追加 */
            color: gray; /* テキスト色をグレーに変更 */
        }

        /* 他のスタイル */
        .task {
            display: flex; /* 横並びにするためにフレックスボックスを使用 */
            align-items: center; /* 垂直方向に中央揃え */
            margin-bottom: 10px; /* タスク間の間隔を追加 */
        }

        .progress-bar {
            height: 5px; /* プログレスバーの高さ */
            background-color: green; /* プログレスバーの色 */
            margin-left: 10px; /* タスクとの間に余白を追加 */
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <h1>To Do</h1>
        <textarea id="taskInput" placeholder="Add tasks (one per line)"></textarea>
        <input type="datetime-local" id="dueDate" /> <!-- 日付と時間を選択できる -->
        <button onclick="addTasks()">Add Tasks</button>
        <button onclick="deleteCompletedTasks()">Delete Completed Tasks</button>
    </div>

    <div class="matrix">
        <div class="quadrant" id="urgent-important" ondrop="drop(event)" ondragover="allowDrop(event)">
            <h2>Your Mission</h2>
            <div class="tasks" id="tasks-urgent-important">
                <div class="task" draggable="true" ondragstart="event.dataTransfer.setData('text', this.id)" id="task-1">
                    <input type="text" value="Submit Project Report" onchange="updateTask('task-1', this.value)">
                    <input type="datetime-local" value="2024-10-05T12:00" onchange="updateDueDate('task-1', this.value)">
                    <input type="checkbox" onchange="markAsCompleted(this, this.parentElement.querySelector('.progress-bar'))">
                    <button onclick="deleteTask('task-1')">Delete</button>
                    <div class="progress-bar" style="width: 0%;"></div>
                </div>
            </div>
        </div>
        <div class="quadrant" id="not-urgent-important" ondrop="drop(event)" ondragover="allowDrop(event)">
            <h2>Self-Investment</h2>
            <div class="tasks" id="tasks-not-urgent-important">
                <div class="task" draggable="true" ondragstart="event.dataTransfer.setData('text', this.id)" id="task-2">
                    <input type="text" value="Read 'Thinking, Fast and Slow'" onchange="updateTask('task-2', this.value)">
                    <input type="datetime-local" value="2024-10-15T12:00" onchange="updateDueDate('task-2', this.value)">
                    <input type="checkbox" onchange="markAsCompleted(this, this.parentElement.querySelector('.progress-bar'))">
                    <button onclick="deleteTask('task-2')">Delete</button>
                    <div class="progress-bar" style="width: 0%;"></div>
                </div>
            </div>
        </div>
        <div class="quadrant" id="urgent-not-important" ondrop="drop(event)" ondragover="allowDrop(event)">
            <h2>Time-Sensitive Tasks</h2>
            <div class="tasks" id="tasks-urgent-not-important">
                <div class="task" draggable="true" ondragstart="event.dataTransfer.setData('text', this.id)" id="task-3">
                    <input type="text" value="Buy groceries for dinner" onchange="updateTask('task-3', this.value)">
                    <input type="datetime-local" value="2024-10-04T18:00" onchange="updateDueDate('task-3', this.value)">
                    <input type="checkbox" onchange="markAsCompleted(this, this.parentElement.querySelector('.progress-bar'))">
                    <button onclick="deleteTask('task-3')">Delete</button>
                    <div class="progress-bar" style="width: 0%;"></div>
                </div>
            </div>
        </div>
        <div class="quadrant" id="not-urgent-not-important" ondrop="drop(event)" ondragover="allowDrop(event)">
            <h2>Wish List</h2>
            <div class="tasks" id="tasks-not-urgent-not-important">
                <div class="task" draggable="true" ondragstart="event.dataTransfer.setData('text', this.id)" id="task-4">
                    <input type="text" value="Watch a new movie" onchange="updateTask('task-4', this.value)">
                    <input type="datetime-local" value="2024-10-20T20:00" onchange="updateDueDate('task-4', this.value)">
                    <input type="checkbox" onchange="markAsCompleted(this, this.parentElement.querySelector('.progress-bar'))">
                    <button onclick="deleteTask('task-4')">Delete</button>
                    <div class="progress-bar" style="width: 0%;"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function addTasks() {
            const taskInput = document.getElementById("taskInput").value;
            const dueDate = document.getElementById("dueDate").value;

            if (taskInput.trim() === "") {
                alert("Please enter a task.");
                return;
            }

            const taskId = `task-${Date.now()}`; // ユニークなIDを生成
            const taskElement = document.createElement("div");
            taskElement.id = taskId;
            taskElement.className = "task";
            taskElement.draggable = true; // ドラッグ可能にする
            taskElement.ondragstart = (event) => event.dataTransfer.setData("text", taskId);

            // 進捗バーを初期化
            const progressBar = document.createElement("div");
            progressBar.className = "progress-bar";
            progressBar.style.width = "0%"; // 初期値は0%

            taskElement.innerHTML = `
                <input type="text" value="${taskInput}" onchange="updateTask('${taskId}', this.value)">
                <input type="datetime-local" value="${dueDate}" onchange="updateDueDate('${taskId}', this.value)">
                <input type="checkbox" onchange="markAsCompleted(this, progressBar)">
                <button onclick="deleteTask('${taskId}')">Delete</button>
            `;

            taskElement.appendChild(progressBar); // 進捗バーをタスク要素に追加

            // 各クワドラントにタスクを追加
            document.querySelector("#urgent-important .tasks").appendChild(taskElement);
            document.getElementById("taskInput").value = ""; // 入力欄をクリア
            document.getElementById("dueDate").value = ""; // 日付入力欄をクリア
        }

        function markAsCompleted(checkbox, progressBar) {
            const taskElement = checkbox.parentElement;
            if (checkbox.checked) {
                progressBar.style.width = "100%"; // 完了時は進捗バーを100%に
                taskElement.classList.add("completed"); // 完了クラスを追加
            } else {
                progressBar.style.width = "0%"; // 未完了時は進捗バーを0%に
                taskElement.classList.remove("completed"); // 完了クラスを削除
            }
        }

        function deleteTask(taskId) {
            const taskElement = document.getElementById(taskId);
            if (taskElement) {
                taskElement.remove(); // タスク要素を削除
            }
        }

        function deleteCompletedTasks() {
            const tasks = document.querySelectorAll('.task');
            tasks.forEach(task => {
                const checkbox = task.querySelector('input[type="checkbox"]');
                if (checkbox && checkbox.checked) {
                    task.remove(); // チェックされたタスクを削除
                }
            });
        }

        function updateTask(taskId, newValue) {
            const taskElement = document.getElementById(taskId);
            if (taskElement) {
                const inputField = taskElement.querySelector('input[type="text"]');
                inputField.value = newValue;
            }
        }

        function updateDueDate(taskId, newDate) {
            const taskElement = document.getElementById(taskId);
            if (taskElement) {
                const dateField = taskElement.querySelector('input[type="datetime-local"]');
                dateField.value = newDate;
            }
        }

        function allowDrop(event) {
            event.preventDefault();
        }

        function drop(event) {
            event.preventDefault(); 
            const taskId = event.dataTransfer.getData("text");
            const taskElement = document.getElementById(taskId);
            const dropzone = event.target.closest(".tasks");
            if (dropzone) {
                dropzone.appendChild(taskElement); 
            }
        }
    </script>
    
    
    
</body>
</html>
